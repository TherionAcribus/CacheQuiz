{% extends "base_public.html" %}

{% block content %}
<div class="me-page">
  <h2>Mon profil</h2>
  <div class="summary-cards">
    <div class="card"><div class="label">Total réponses</div><div class="value">{{ total_answers }}</div></div>
    <div class="card"><div class="label">Total réussites</div><div class="value">{{ total_success }}</div></div>
    <div class="card"><div class="label">Taux global</div><div class="value">{% if total_answers %}{{ ((total_success/total_answers)*100)|round(1) }}%{% else %}0%{% endif %}</div></div>
  </div>

  <h3>Dernières questions</h3>
  <table class="table">
    <thead>
      <tr>
        <th>Date</th>
        <th>Question</th>
        <th>Votre choix</th>
        <th>Statut</th>
      </tr>
    </thead>
    <tbody>
      {% for s in stats %}
      <tr>
        <td>{{ s.last_answered_at.strftime('%Y-%m-%d %H:%M') if s.last_answered_at else '' }}</td>
        <td>{{ s.question.question_text[:80] }}{% if s.question.question_text|length > 80 %}…{% endif %}</td>
        <td>{{ s.last_selected_answer }}</td>
        <td>{% if s.last_is_correct %}✅{% else %}❌{% endif %}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<style>
.summary-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:.5rem;margin-bottom:1rem}
.summary-cards .card{border:1px solid var(--border-color);border-radius:.5rem;padding:.75rem;background:var(--card-bg)}
.summary-cards .label{color:var(--muted-color);font-size:.9rem}
.summary-cards .value{font-size:1.25rem;font-weight:700}
.table{width:100%;border-collapse:collapse}
.table th,.table td{border-bottom:1px solid var(--border-color);padding:.5rem;text-align:left}
</style>
{% endblock %}


